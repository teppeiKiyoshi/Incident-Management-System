import React from "react";
import logo from "../../images/logos/logoTxt-dark.png";
import reportHeader from "../../images/report-header.png";

const formatDate = (dateStr) => {
  let date = new Date(dateStr);
  const monthNames = [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December",
  ];

  var hours = date.getHours();
  var minutes = date.getMinutes();
  var ampm = hours >= 12 ? "pm" : "am";
  hours = hours % 12;
  hours = hours ? hours : 12; // the hour '0' should be '12'
  minutes = minutes < 10 ? "0" + minutes : minutes;
  var strTime = hours + ":" + minutes + " " + ampm;

  return monthNames[date.getMonth()] + " " + date.getDate() + " - " + strTime;
};

const formatIncident = (string) => {
  switch (string) {
    case "remainingBalance":
      return "Remaining Balance";
    case "failedSubj":
      return "Failed Subject";
    case "addSubj":
      return "Adding Subject";
    case "changeSubj":
      return "Changing Subject";
    case "incSubj":
      return "Subjects with INC";
    case "prevSem":
      return "Unavailable Subjects from Previous Semester";
    case "currSem":
      return "Unavailable Subjects from Previous Semester";
    case "others":
      return "Others";
  }
};

const DataComponent = React.forwardRef((props, ref) => (
  <div
    ref={ref}
    className="paper"
    style={{
      width: "8.5in",
      height: "auto",
      fontSize: "0.9em",
      padding: "20px",
      display: "flex",
      flexDirection: "column",
      position: "relative",
    }}
  >
    <div
      className="paper-header"
      style={{
        display: "flex",
        flexDirection: "column",
        alignItems: "center",
        marginBottom: "20px",
      }}
    >
      <div
        className="report-header"
        style={{
          width: "100%",
          top: "0",
          height: "200px",
          position: "absolute",
        }}
      >
        <img src={reportHeader} style={{ width: "600px" }} />
      </div>

      <span style={{ marginTop: "150px", fontSize: "0.8em" }}>
        In cooperation with
      </span>
      <div
        className="logo"
        style={{
          width: "130px",
          height: "60px",
          display: "flex",
          justifyContent: "center",
          alignItems: "center",
        }}
      >
        <img src={logo} style={{ width: "100%" }} />
      </div>
      <span>Reports {props.filter}</span>
      <span>Date: {props.date}</span>
      <span>Report Generated by: {props.fullname}</span>
    </div>
    {/* <table
      style={{ borderCollapse: "collapse", border: "solid 2px lightgrey" }}
    >
      <thead>
        <th>Report ID</th>
        <th>Main Concern</th>
        <th>Incident Type</th>
        <th>Date/Time Reported</th>
        <th>Reported By</th>
        <th>Evaluated By</th>
        <th>Replies</th>
        <th>Status</th>
      </thead>
      <tbody>
        {props.reports.map((report) => {
          return (
            <tr>
              <td
                style={{
                  borderCollapse: "collapse",
                  border: "solid 2px lightgrey",
                  wordBreak: "break-all",
                }}
              >
                {report._id}
              </td>
              <td
                style={{
                  borderCollapse: "collapse",
                  border: "solid 2px lightgrey",
                }}
              >
                {report.mainConcern}
              </td>
              <td
                style={{
                  borderCollapse: "collapse",
                  border: "solid 2px lightgrey",
                }}
              >
                {formatIncident(report.incident)}
              </td>
              <td
                style={{
                  borderCollapse: "collapse",
                  border: "solid 2px lightgrey",
                }}
              >
                {formatDate(report.createdAt)}
              </td>
              <td
                style={{
                  borderCollapse: "collapse",
                  border: "solid 2px lightgrey",
                }}
              >
                {report.reportedByName}
              </td>
              <td
                style={{
                  borderCollapse: "collapse",
                  border: "solid 2px lightgrey",
                }}
              >
                {report.evaluatedByName}
              </td>
              <td
                style={{
                  borderCollapse: "collapse",
                  border: "solid 2px lightgrey",
                }}
              >
                {report.comments.map((comment) => {
                  return (
                    <div>
                      <div>{`- ${comment.comment}`}</div>
                      <br />
                    </div>
                  );
                })}
              </td>
              <td
                style={{
                  borderCollapse: "collapse",
                  border: "solid 2px lightgrey",
                }}
              >
                {report.status}
              </td>
            </tr>
          );
        })}
      </tbody>
    </table> */}
    <div style={{ padding: "0 70px" }}>
      {props.reports.map((report) => {
        return (
          <div
            style={{
              border: "1px solid black",
              marginBottom: "40px",
              borderBottom: "none",
            }}
          >
            <div
              style={{
                borderBottom: "1px solid black",
                display: "flex",
                justifyContent: "space-between",
              }}
            >
              <span
                style={{
                  padding: "8px",
                  width: "50%",
                  borderRight: "1px solid black",
                }}
              >
                <b>Report ID:</b> {report._id}
              </span>
              <span style={{ padding: "8px", width: "50%" }}>
                <b>Status:</b> {report.status}
              </span>
            </div>

            <div
              style={{
                borderBottom: "1px solid black",
                display: "flex",
                justifyContent: "space-between",
              }}
            >
              <span
                style={{
                  padding: "8px",
                  width: "50%",
                  borderRight: "1px solid black",
                }}
              >
                <b>Reported By:</b> {report.reportedByName}
              </span>
              <span style={{ padding: "8px", width: "50%" }}>
                <b>Date Reported:</b> {formatDate(report.createdAt)}
              </span>
            </div>

            <div
              style={{
                borderBottom: "1px solid black",
                display: "flex",
                justifyContent: "space-between",
              }}
            >
              <span
                style={{
                  padding: "8px",
                  width: "50%",
                  borderRight: "1px solid black",
                }}
              >
                <b>Evaluated by:</b> {report.evaluatedByName}
              </span>
              <span style={{ padding: "8px", width: "50%" }}>
                <b>Incident type:</b> {formatIncident(report.incident)}
              </span>
            </div>

            <div
              style={{
                borderBottom: "1px solid black",
                display: "flex",
                justifyContent: "space-between",
              }}
            >
              <span style={{ padding: "8px" }}>
                <b>Main Concern:</b> {report.mainConcern}
              </span>
            </div>

            <div
              style={{
                borderBottom: "1px solid black",
                display: "flex",
                justifyContent: "space-between",
              }}
            >
              <span
                style={{
                  padding: "8px",
                  fontWeight: "bold",
                  width: "100%",
                  textAlign: "center",
                }}
              >
                CONTENT RESOLUTION
              </span>
            </div>

            <div style={{ display: "flex", flexDirection: "column" }}>
              {report.comments ? (
                report.comments.map((comment) => {
                  return (
                    <span
                      style={{
                        padding: "8px",
                        borderBottom: "1px solid black",
                      }}
                    >{`- ${comment.comment}`}</span>
                  );
                })
              ) : (
                <span
                  style={{ padding: "8px", borderBottom: "1px solid black" }}
                >
                  - None
                </span>
              )}
            </div>
          </div>
        );
      })}
    </div>
  </div>
));

export default DataComponent;
